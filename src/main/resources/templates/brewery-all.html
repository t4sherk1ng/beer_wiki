<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments/head :: head('Beer Wiki — Пивоварни')"></head>

<body>
<nav th:replace="fragments/navbar :: navbar"></nav>

<main class="container">
    <hgroup>
        <h1 style="font-family: 'Cinzel', serif; margin-bottom: 0.3rem;">Все пивоварни</h1>
        <p style="margin-top: 0;">Просмотр и поиск пивоварен</p>
    </hgroup>

    <div th:if="${successMessage}"
         style="padding: 0.8rem 1rem; margin-bottom: 1rem; background-color: #235b2f; border-radius: 8px;">
        <p th:text="${successMessage}" style="margin: 0; color: #e6e3df;"></p>
    </div>

    <form method="get" action="/breweries/all" style="margin-bottom: 20px;">
        <div style="display: grid; grid-template-columns: 1fr auto; gap: 10px;">
            <input type="search"
                   name="search"
                   th:value="${search}"
                   placeholder="Поиск по названию пивоварни..."
                   aria-label="Поиск"
                   style="padding: 8px 10px; border-radius: 6px; border: 1px solid #3c3c3c; background: #141414; color: #e6e3df;">
            <button type="submit"
                    style="background: #8ab4ff; color: #0b0b0b; border: none; padding: 8px 18px; border-radius: 6px; font-weight: 600;">
                Найти
            </button>
        </div>
    </form>

    <section th:if="${breweries != null and !#lists.isEmpty(breweries)}"
             style="display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 16px;">
        <article class="card" th:each="brewery : ${breweries}">
            <h3 th:text="${brewery.name}" style="margin-top: 0;"></h3>
            <p style="margin: 4px 0;">
                <strong>Локация:</strong>
                <span th:text="${brewery.location}"></span>
            </p>
            <p style="margin: 4px 0 10px;">
                <strong>Описание:</strong>
                <span th:text="${#strings.abbreviate(brewery.description, 120)}"></span>
            </p>
            <a th:href="@{/breweries/{id}(id=${brewery.id})}"
               style="font-weight: 600; font-size: 14px;">
                Подробнее о пивоварне →
            </a>
        </article>
    </section>

    <p th:if="${breweries == null or #lists.isEmpty(breweries)}">
        <em>Пивоварни не найдены. Попробуйте изменить критерии поиска или добавьте новую пивоварню.</em>
    </p>

    <nav th:if="${totalPages != null and totalPages > 1}" aria-label="Pagination" style="margin-top: 25px;">
        <ul style="display: flex; justify-content: center; list-style: none; padding: 0; gap: 10px; align-items: center;">
            <li th:if="${currentPage > 0}">
                <a th:href="@{/breweries/all(page=${currentPage - 1}, size=10)}"
                   style="padding: 6px 14px; border-radius: 6px; border: 1px solid #3c3c3c; color: #e6e3df;">
                    ← Назад
                </a>
            </li>
            <li>
                <span>Страница
                    <strong th:text="${currentPage + 1}"></strong>
                    из
                    <strong th:text="${totalPages}"></strong>
                </span>
            </li>
            <li th:if="${currentPage + 1 < totalPages}">
                <a th:href="@{/breweries/all(page=${currentPage + 1}, size=10)}"
                   style="padding: 6px 14px; border-radius: 6px; border: 1px solid #3c3c3c; color: #e6e3df;">
                    Вперёд →
                </a>
            </li>
        </ul>
    </nav>
</main>

<footer th:replace="fragments/footer :: footer"></footer>
</body>
</html>